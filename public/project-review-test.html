<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Project Review - Testing Key Fixes</title>
  
  <!-- Load modular CSS -->
  <link rel="stylesheet" href="css/modular/variables.css">
  <link rel="stylesheet" href="css/modular/components.css">
  <link rel="stylesheet" href="css/modular/gsap-animations.css">
  
  <!-- GSAP -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/SplitText.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrambleTextPlugin.min.js"></script>
  
  <style>
    body {
      margin: 0;
      padding: 20px;
      background: #0a0a0f;
      color: #ffffff;
      font-family: 'Inter', sans-serif;
      min-height: 100vh;
    }
    
    .test-section {
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid rgba(255, 255, 255, 0.08);
      border-radius: 12px;
      padding: 20px;
      margin: 20px 0;
    }
    
    .test-section h2 {
      color: #00ff88;
      margin-top: 0;
    }
    
    .btn {
      background: #00ff88;
      color: #000;
      border: none;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
      margin: 5px;
      font-weight: 600;
    }
    
    .btn:hover {
      background: #33ff99;
    }
    
    .popup-test {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(17, 17, 24, 0.95);
      border: 1px solid #00ff88;
      border-radius: 12px;
      padding: 20px;
      min-width: 300px;
      text-align: center;
      display: none;
      z-index: 1000;
    }
    
    .popup-test.active {
      display: block;
    }
    
    .status {
      background: rgba(0, 255, 136, 0.1);
      border: 1px solid #00ff88;
      border-radius: 6px;
      padding: 10px;
      margin: 10px 0;
      font-family: monospace;
      font-size: 14px;
    }
  </style>
</head>
<body>
  <h1>üîß Project Review - Key Fixes Testing</h1>
  
  <div class="test-section">
    <h2>‚úÖ 1. Popup Duration Fix - 0 = Stay Until Dismissed</h2>
    <p>Testing that popups with 0 duration stay visible until manually dismissed.</p>
    
    <button class="btn" onclick="testPopupDuration(0)">Test 0 Seconds (Stay Until Dismissed)</button>
    <button class="btn" onclick="testPopupDuration(3)">Test 3 Seconds (Auto-Hide)</button>
    <button class="btn" onclick="hideTestPopup()">Manual Dismiss</button>
    
    <div id="popup-status" class="status">Ready to test popup duration behavior...</div>
  </div>
  
  <div class="test-section">
    <h2>üé¨ 2. GSAP Text Materialization</h2>
    <p>Testing character-by-character reveals with panel scaling.</p>
    
    <button class="btn" onclick="testGSAPAnimation('character')">Character Reveal</button>
    <button class="btn" onclick="testGSAPAnimation('typewriter')">Typewriter Effect</button>
    <button class="btn" onclick="testGSAPAnimation('scramble')">Scramble Text</button>
    
    <div id="gsap-demo" style="background: rgba(255, 255, 255, 0.05); padding: 20px; margin: 15px 0; border-radius: 8px; min-height: 60px; overflow: hidden;">
      <div class="demo-text">Ready for GSAP animation test...</div>
    </div>
    
    <div id="gsap-status" class="status">GSAP system ready...</div>
  </div>
  
  <div class="test-section">
    <h2>üìÅ 3. File Structure Cleanup</h2>
    <p>Verification of simplified project structure.</p>
    
    <div class="status">
      <strong>‚úÖ Completed Actions:</strong><br>
      ‚Ä¢ Removed duplicate HTML files (dashboard-pro, dashboard-ultimate, etc.)<br>
      ‚Ä¢ Renamed dashboard-merged.html ‚Üí dashboard.html<br>
      ‚Ä¢ Moved demo files to public/demos/ folder<br>
      ‚Ä¢ Only 2 main files remain: dashboard.html + output.html
    </div>
    
    <button class="btn" onclick="window.open('dashboard.html', '_blank')">Open Dashboard</button>
    <button class="btn" onclick="window.open('output.html', '_blank')">Open Output</button>
    <button class="btn" onclick="window.open('demos/', '_blank')">View Demos Folder</button>
  </div>
  
  <div class="test-section">
    <h2>‚öôÔ∏è 4. Widget System Status</h2>
    <div id="widget-status" class="status">Checking widget system...</div>
    <button class="btn" onclick="checkWidgetSystem()">Check Widget Components</button>
  </div>

  <!-- Test popup -->
  <div id="test-popup" class="popup-test">
    <div class="popup-content">
      <h3>üß™ Test Popup</h3>
      <div class="popup-text">Test message will appear here...</div>
      <div class="popup-duration">Duration: <span id="duration-display">--</span></div>
      <br>
      <button class="btn" onclick="hideTestPopup()">Dismiss Manually</button>
    </div>
  </div>

  <!-- Load modular components for testing -->
  <script src="js/shared-utils.js"></script>
  <script src="js/modular/state-manager-enhanced.js"></script>
  <script src="js/modular/gsap-animation-controller.js"></script>

  <script>
    let testTimer = null;
    let gsapController = null;
    let stateManager = null;

    // Initialize systems
    document.addEventListener('DOMContentLoaded', () => {
      try {
        stateManager = new ModularStateManager();
        gsapController = new GSAPAnimationController();
        updateStatus('gsap-status', '‚úÖ GSAP Animation Controller initialized');
        updateStatus('widget-status', '‚úÖ State Manager initialized');
      } catch (error) {
        updateStatus('gsap-status', '‚ùå Error: ' + error.message);
        updateStatus('widget-status', '‚ùå Error: ' + error.message);
      }
    });

    function testPopupDuration(durationSeconds) {
      const popup = document.getElementById('test-popup');
      const durationDisplay = document.getElementById('duration-display');
      const statusEl = document.getElementById('popup-status');
      
      // Clear any existing timer
      if (testTimer) {
        clearTimeout(testTimer);
        testTimer = null;
      }
      
      // Show popup
      popup.classList.add('active');
      durationDisplay.textContent = durationSeconds === 0 ? 'Stay until dismissed' : durationSeconds + 's';
      
      if (durationSeconds === 0) {
        updateStatus('popup-status', '‚úÖ Popup shown with 0 duration - will stay until manually dismissed');
      } else {
        updateStatus('popup-status', `‚è±Ô∏è Popup shown with ${durationSeconds}s duration - will auto-hide`);
        
        // Auto-hide after specified duration
        testTimer = setTimeout(() => {
          hideTestPopup();
          updateStatus('popup-status', `‚úÖ Popup auto-hidden after ${durationSeconds} seconds`);
        }, durationSeconds * 1000);
      }
    }

    function hideTestPopup() {
      const popup = document.getElementById('test-popup');
      popup.classList.remove('active');
      
      if (testTimer) {
        clearTimeout(testTimer);
        testTimer = null;
        updateStatus('popup-status', '‚úÖ Popup manually dismissed (timer cleared)');
      } else {
        updateStatus('popup-status', '‚úÖ Popup manually dismissed');
      }
    }

    function testGSAPAnimation(type) {
      if (!gsapController) {
        updateStatus('gsap-status', '‚ùå GSAP Controller not available');
        return;
      }
      
      const demo = document.getElementById('gsap-demo');
      const texts = {
        character: 'üé¨ Watch each character materialize with 3D rotation!',
        typewriter: '‚å®Ô∏è Classic typewriter effect with blinking cursor...',
        scramble: 'üéØ Matrix-style scramble text transformation!'
      };
      
      demo.innerHTML = '<div class="demo-text"></div>';
      
      const config = {
        effect: type,
        panelScale: true,
        glow: true,
        duration: 2.0
      };
      
      if (type === 'typewriter') config.typewriter = true;
      if (type === 'scramble') config.scramble = true;
      
      try {
        gsapController.animateTextMaterialization(demo, texts[type], config);
        updateStatus('gsap-status', `üé¨ ${type.charAt(0).toUpperCase() + type.slice(1)} animation started`);
      } catch (error) {
        updateStatus('gsap-status', '‚ùå Animation error: ' + error.message);
      }
    }

    function checkWidgetSystem() {
      const checks = [];
      
      // Check if GSAP is available
      checks.push(['GSAP Library', typeof window.gsap !== 'undefined']);
      checks.push(['SplitText Plugin', typeof window.SplitText !== 'undefined']);
      checks.push(['ScrambleText Plugin', typeof window.ScrambleTextPlugin !== 'undefined']);
      
      // Check modular components
      checks.push(['State Manager', stateManager !== null]);
      checks.push(['GSAP Controller', gsapController !== null]);
      
      // Check if GSAP controller methods exist
      if (gsapController) {
        checks.push(['Text Materialization', typeof gsapController.animateTextMaterialization === 'function']);
        checks.push(['Popup Animation', typeof gsapController.animatePopupAppearance === 'function']);
        checks.push(['BRB Animation', typeof gsapController.animateBRBAppearance === 'function']);
      }
      
      const results = checks.map(([name, status]) => 
        `${status ? '‚úÖ' : '‚ùå'} ${name}`
      ).join('<br>');
      
      updateStatus('widget-status', results);
    }

    function updateStatus(elementId, message) {
      const el = document.getElementById(elementId);
      if (el) {
        el.innerHTML = message;
      }
      console.log(`[Test] ${elementId}: ${message}`);
    }

    // Auto-run initial checks
    setTimeout(checkWidgetSystem, 1000);
  </script>
</body>
</html>